# API Docs:
# https://www.reddit.com/r/redditdev/wiki/api/

label: reddit-hot-posts
processors:
  - mutation: |
      meta limit = @limit.number(25)
      meta limit = [ @limit, 100 ].min()
      meta limit = [ @limit, 1 ].max()

      meta query_string = "&limit=%v".format(content().escape_url_query(), @limit)
      meta subreddit = content().string()

      root = ""
  - http:
      url: "https://www.reddit.com/r/${! @subreddit }/hot.json?${! @query_string }"
      verb: GET
  - mapping: 'root = this.data.children.map_each(post -> post.data)'
  - unarchive:
      format: json_array

meta:
  mcp:
    enabled: true
    description: Obtain the top hot posts on a specified subreddit.
    properties:
      - name: limit
        type: number
        description: "An optional limit of posts to search for, between 1 and 100 inclusive. Defaults to 25."

